# Проект: Прогнозирование стоимости страховых выплат

## Описание проекта

В рамках практического задания реализована модель машинного обучения для прогнозирования итоговой стоимости страхового возмещения работников (**UltimateIncurredClaimCost**) на основе характеристик сотрудника и параметров страхового случая.

Работа выполнена в виде интерактивного веб-приложения на **Streamlit** с двумя страницами:

* анализ данных и обучение моделей,
* презентация проекта.

Модель позволяет:

* загрузить датасет,
* выполнить предобработку,
* обучить несколько алгоритмов регрессии,
* сравнить их по метрикам,
* визуализировать результаты,
* получить прогноз для нового страхового случая.

---

## Цель проекта

Построить модель регрессии, которая предсказывает итоговую стоимость страховой выплаты на основе:

* характеристик работника,
* условий занятости,
* начальной оценки страхового случая.

Такая модель может использоваться страховыми компаниями для:

* планирования финансовых резервов,
* оценки рисков,
* формирования тарифов.

---

## Датасет

Используется датасет **Workers Compensation** (OpenML ID: 42876).

В нем содержится около **100 000 записей** о страховых случаях с набором признаков:
* DateTimeOfAccident — дата и время несчастного случая
* DateReported — дата сообщения о страховом случае
* Age — возраст работника
* Gender — пол работника (M/F)
* MaritalStatus — семейное положение работника
* DependentChildren — количество детей на иждивении
* DependentsOther — количество других иждивенцев
* WeeklyPay — еженедельная заработная плата
* PartTimeFullTime — тип занятости (Part Time / Full Time)
* HoursWorkedPerWeek — количество рабочих часов в неделю
* DaysWorkedPerWeek — количество рабочих дней в неделю
* ClaimDescription — описание страхового случая
* InitialCaseEstimate — начальная оценка стоимости страхового случая

### Целевая переменная

* **UltimateIncurredClaimCost** — итоговая стоимость страхового возмещения

---

## Используемые модели

В проекте обучаются и сравниваются несколько алгоритмов регрессии:

1. **Linear Regression**

   * простая и интерпретируемая модель

2. **Ridge Regression**

   * линейная модель с регуляризацией

3. **Random Forest Regressor**

   * ансамблевая модель на основе деревьев решений
   * хорошо работает на нелинейных зависимостях

4. **XGBoost Regressor** (опционально)

   * градиентный бустинг
   * часто показывает лучшую точность

---

## Используемые метрики

Для оценки качества моделей применяются:

* **MAE** — средняя абсолютная ошибка
* **MSE** — средняя квадратичная ошибка
* **RMSE** — корень из MSE
* **R²** — коэффициент детерминации

Лучшая модель выбирается по минимальному значению **RMSE**.

---

## Установка и запуск проекта

### 1. Клонирование репозитория

```bash
git clone https://github.com/Dm1try007/workers_compensation_project_CK
cd workers_compensation_project
```

### 2. Создание виртуального окружения (рекомендуется)

**Windows:**

```bash
python -m venv .venv
.venv\Scripts\activate
```

**Linux / macOS:**

```bash
python -m venv .venv
source .venv/bin/activate
```

### 3. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 4. Запуск приложения

```bash
streamlit run app.py
```

После запуска приложение откроется в браузере.

---

## Работа с приложением

### Страница «Анализ и модель»

Позволяет:

1. Загрузить датасет.
2. Посмотреть структуру данных.
3. Выполнить предобработку.
4. Обучить модели.
5. Сравнить их по метрикам.
6. Посмотреть графики.
7. Получить прогноз для нового случая.

### Страница «Презентация»

Содержит краткое описание проекта в формате слайдов.

---

## Видео-демонстрация

В папке `video/` находится файл:

```
demo.mp4
```

В видео показывается:

* клонирование проекта,
* установка зависимостей,
* запуск приложения,
* демонстрация всех функций.

---

## Используемые библиотеки

* streamlit
* pandas
* numpy
* scikit-learn
* matplotlib
* seaborn
* xgboost
* streamlit-reveal-slides

---

## Автор

Студент программы цифровой кафедры по направлению «Искусственный интеллект в инженерии».

Сафин Д.И. Группа № 5182.
